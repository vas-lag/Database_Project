2.
SELECT AVG(misthos) 
FROM THESI_ERGASIAS t JOIN ANHKEI a
ON t.kod_theshs = a.kod_ergasias 
WHERE 	a.tomeas LIKE "%Τεχνικοί%" 
AND t.topos LIKE "%%"


4.
SELECT onoma,eponymo,email,thlefwno
FROM ((((ENDIAFEROMENOS e JOIN AITHSH_ERGASIAS a
ON e.kod_endiaferomenou = a.kod_endiaferomenou_aithshs) JOIN PERILAMVANEI pe
ON a.kod_aithshs = pe.aithsh) JOIN PROSONTA pr
ON pe.proson = pr.kod_prosontos) JOIN PTYXIO pt
ON pr.kod_prosontos = pt.kod_prosontos) JOIN THLEFWNO_ENDIAFEROMENOU t
ON e.kod_endiaferomenou = t.endiaferomenos
WHERE a.topos_endiaferontos LIKE "%X%"
AND pt.antikeimeno LIKE "%Y%"


7.
SELECT DISTINCT t1.*
FROM (SELECT DISTINCT th.*
FROM AITHSH_ERGASIAS ai JOIN ((((THESI_ERGASIAS th LEFT JOIN PROYPOTHETEI proipo
ON th.kod_theshs = proipo.kod_ergasias) LEFT JOIN PROIPIRESIA proipiresia2
ON proipo.kod_proipiresias = proipiresia2.kod_proipiresias) JOIN PROIPIRESIA proipiresia1
ON ((proipiresia2.tomeas = proipiresia1.tomeas AND proipiresia2.diarkeia <= proipiresia1.diarkeia) OR proipiresia2.tomeas IS NULL)) JOIN DIATHETEI d
ON proipiresia1.kod_proipiresias = d.kod_proipiresias)
ON (ai.kod_aithshs = d.aithsh AND proipiresia1.tomeas IS NOT NULL) OR proipiresia2.tomeas IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou JOIN AFORA af
ON ai.kod_aithshs = af.aithsh JOIN TOMEAS_ERGASIAS tomeas
ON af.tomeas = tomeas.onoma JOIN ANHKEI an
ON tomeas.onoma = an.tomeas AND th.kod_theshs = an.kod_ergasias
WHERE e.kod_endiaferomenou = 23) AS t1,
(SELECT DISTINCT th.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM PTYXIO p)) LEFT JOIN PTYXIO ptyxio2
ON (apa.proson = ptyxio2.kod_prosontos) JOIN PTYXIO ptyxio1
ON (ptyxio2.antikeimeno = ptyxio1.antikeimeno) OR (ptyxio2.antikeimeno IS NULL) JOIN PERILAMVANEI pe
ON ptyxio1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND ptyxio1.antikeimeno IS NOT NULL)	OR ptyxio2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE e.kod_endiaferomenou = 23) AS t2,
(SELECT DISTINCT th.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON apa.proson = gnosh2.kod_prosontos JOIN GNOSH gnosh1
ON (gnosh2.antikeimeno = gnosh1.antikeimeno) OR (gnosh2.antikeimeno IS NULL) JOIN PERILAMVANEI pe
ON gnosh1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND gnosh1.antikeimeno IS NOT NULL)	OR gnosh2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE e.kod_endiaferomenou = 23
GROUP BY th.kod_theshs 
HAVING COUNT(gnosh1.antikeimeno) >= (SELECT COUNT(gnosh2.antikeimeno)
FROM THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON (apa.proson = gnosh2.kod_prosontos)
WHERE e.kod_endiaferomenou = 23)) AS t3
WHERE t1.kod_theshs = t2.kod_theshs
AND t2.kod_theshs = t3.kod_theshs








SELECT DISTINCT th.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON apa.proson = gnosh2.kod_prosontos JOIN GNOSH gnosh1
ON (gnosh2.antikeimeno = gnosh1.antikeimeno) OR (gnosh2.antikeimeno IS NULL) JOIN PERILAMVANEI pe
ON gnosh1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND gnosh1.antikeimeno IS NOT NULL)	OR gnosh2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE ai.kod_aithshs = 1
GROUP BY th.kod_theshs 
HAVING COUNT(gnosh1.antikeimeno) >= (SELECT COUNT(gnosh2.antikeimeno)
FROM THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON (apa.proson = gnosh2.kod_prosontos)
WHERE ai.kod_aithshs = 1)




SELECT *
FROM THESI_ERGASIAS t LEFT JOIN PROYPOTHETEI p
ON t.kod_theshs = p.kod_ergasias LEFT JOIN PROIPIRESIA pro
ON p.kod_proipiresias = pro.kod_proipiresias
WHERE pro.tomeas IN (SELECT pro2.tomeas FROM ENDIAFEROMENOS e JOIN AITHSH_ERGASIAS ai
ON e.kod_endiaferomenou = ai.kod_endiaferomenou_aithshs LEFT JOIN DIATHETEI d
ON ai.kod_aithshs = d.aithsh LEFT JOIN PROIPIRESIA pro2
ON d.kod_proipiresias = pro2.kod_proipiresias
WHERE e.kod_endiaferomenou = 20) 
OR pro.tomeas IS NULL


SELECT t.*
FROM THESI_ERGASIAS t LEFT JOIN APAITEI a
ON t.kod_theshs = a.kod_ergasias LEFT JOIN GNOSH g
ON a.proson = g.kod_prosontos
WHERE g.antikeimeno IN (SELECT g2.antikeimeno FROM ENDIAFEROMENOS e JOIN AITHSH_ERGASIAS ai
ON e.kod_endiaferomenou = ai.kod_endiaferomenou_aithshs LEFT JOIN PERILAMVANEI pe
ON ai.kod_aithshs = pe.aithsh LEFT JOIN GNOSH g2
ON pe.proson = g2.kod_prosontos
WHERE e.kod_endiaferomenou = 1) 
OR g.antikeimeno IS NULL




6.
SELECT DISTINCT t1.*
FROM (SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN ((((THESI_ERGASIAS th LEFT JOIN PROYPOTHETEI proipo
ON th.kod_theshs = proipo.kod_ergasias) LEFT JOIN PROIPIRESIA proipiresia2
ON proipo.kod_proipiresias = proipiresia2.kod_proipiresias) JOIN PROIPIRESIA proipiresia1
ON ((proipiresia2.tomeas = proipiresia1.tomeas AND proipiresia2.diarkeia <= proipiresia1.diarkeia) OR proipiresia2.tomeas IS NULL)) JOIN DIATHETEI d
ON proipiresia1.kod_proipiresias = d.kod_proipiresias)
ON (ai.kod_aithshs = d.aithsh AND proipiresia1.tomeas IS NOT NULL) OR proipiresia2.tomeas IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou JOIN AFORA af
ON ai.kod_aithshs = af.aithsh JOIN TOMEAS_ERGASIAS tomeas
ON af.tomeas = tomeas.onoma JOIN ANHKEI an
ON tomeas.onoma = an.tomeas AND th.kod_theshs = an.kod_ergasias
WHERE th.kod_theshs = 48) AS t1,
(SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM PTYXIO p)) LEFT JOIN PTYXIO ptyxio2
ON (apa.proson = ptyxio2.kod_prosontos) JOIN PTYXIO ptyxio1
ON (ptyxio2.antikeimeno = ptyxio1.antikeimeno) OR (ptyxio2.antikeimeno IS NULL) JOIN PERILAMVANEI pe
ON ptyxio1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND ptyxio1.antikeimeno IS NOT NULL)	OR ptyxio2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE th.kod_theshs = 48) AS t2,
(SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON apa.proson = gnosh2.kod_prosontos JOIN GNOSH gnosh1
ON (gnosh2.antikeimeno = gnosh1.antikeimeno) OR gnosh2.antikeimeno IS NULL JOIN PERILAMVANEI pe
ON gnosh1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND gnosh1.antikeimeno IS NOT NULL)	OR gnosh2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE th.kod_theshs = 48
GROUP BY ai.kod_aithshs 
HAVING COUNT(gnosh1.antikeimeno) >= (SELECT COUNT(gnosh2.antikeimeno)
FROM THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON (apa.proson = gnosh2.kod_prosontos)
WHERE th.kod_theshs = 48)) AS t3
WHERE t1.kod_endiaferomenou = t2.kod_endiaferomenou
AND t2.kod_endiaferomenou = t3.kod_endiaferomenou

















SELECT DISTINCT t1.*
FROM (SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN ((((THESI_ERGASIAS th LEFT JOIN PROYPOTHETEI proipo
ON th.kod_theshs = proipo.kod_ergasias) LEFT JOIN PROIPIRESIA proipiresia2
ON proipo.kod_proipiresias = proipiresia2.kod_proipiresias) JOIN PROIPIRESIA proipiresia1
ON ((proipiresia2.tomeas = proipiresia1.tomeas AND proipiresia2.diarkeia <= proipiresia1.diarkeia) OR (proipiresia2.tomeas IS NULL AND proipiresia1.posto IS NOT NULL))) JOIN DIATHETEI d
ON proipiresia1.kod_proipiresias = d.kod_proipiresias)
ON (ai.kod_aithshs = d.aithsh AND proipiresia1.tomeas IS NOT NULL) OR (proipiresia2.tomeas IS NULL)JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou JOIN AFORA af
ON ai.kod_aithshs = af.aithsh JOIN TOMEAS_ERGASIAS tomeas
ON af.tomeas = tomeas.onoma JOIN ANHKEI an
ON tomeas.onoma = an.tomeas AND th.kod_theshs = an.kod_ergasias
WHERE th.kod_theshs = 1) AS t1,
(SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM PTYXIO p)) LEFT JOIN PTYXIO ptyxio2
ON (apa.proson = ptyxio2.kod_prosontos) JOIN PTYXIO ptyxio1
ON (ptyxio2.antikeimeno = ptyxio1.antikeimeno AND ptyxio1.foreas IS NOT NULL) OR (ptyxio2.antikeimeno IS NULL AND ptyxio1.foreas IS NOT NULL) JOIN PERILAMVANEI pe
ON ptyxio1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND ptyxio1.antikeimeno IS NOT NULL)	OR ptyxio2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE th.kod_theshs = 1) AS t2,
(SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON apa.proson = gnosh2.kod_prosontos JOIN GNOSH gnosh1
ON (gnosh2.antikeimeno = gnosh1.antikeimeno AND gnosh1.zhteitai = 0) OR (gnosh2.antikeimeno IS NULL AND gnosh1.zhteitai = 0) JOIN PERILAMVANEI pe
ON gnosh1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND gnosh1.antikeimeno IS NOT NULL)	OR gnosh2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE th.kod_theshs = 1
GROUP BY ai.kod_aithshs 
HAVING COUNT(gnosh1.antikeimeno) >= (SELECT COUNT(gnosh2.antikeimeno)
FROM THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON (apa.proson = gnosh2.kod_prosontos)
WHERE th.kod_theshs = 1)) AS t3
WHERE t1.kod_endiaferomenou = t2.kod_endiaferomenou
AND t2.kod_endiaferomenou = t3.kod_endiaferomenou






SELECT DISTINCT t1.*
FROM (SELECT DISTINCT th.*
FROM AITHSH_ERGASIAS ai JOIN ((((THESI_ERGASIAS th LEFT JOIN PROYPOTHETEI proipo
ON th.kod_theshs = proipo.kod_ergasias) LEFT JOIN PROIPIRESIA proipiresia2
ON proipo.kod_proipiresias = proipiresia2.kod_proipiresias) JOIN PROIPIRESIA proipiresia1
ON ((proipiresia2.tomeas = proipiresia1.tomeas AND proipiresia2.diarkeia <= proipiresia1.diarkeia) OR (proipiresia2.tomeas IS NULL AND proipiresia1.posto IS NOT NULL))) JOIN DIATHETEI d
ON proipiresia1.kod_proipiresias = d.kod_proipiresias)
ON (ai.kod_aithshs = d.aithsh AND proipiresia1.tomeas IS NOT NULL) OR (proipiresia2.tomeas IS NULL)JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou JOIN AFORA af
ON ai.kod_aithshs = af.aithsh JOIN TOMEAS_ERGASIAS tomeas
ON af.tomeas = tomeas.onoma JOIN ANHKEI an
ON tomeas.onoma = an.tomeas AND th.kod_theshs = an.kod_ergasias
WHERE e.kod_endiaferomenou = 70) AS t1,
(SELECT DISTINCT th.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM PTYXIO p)) LEFT JOIN PTYXIO ptyxio2
ON (apa.proson = ptyxio2.kod_prosontos) JOIN PTYXIO ptyxio1
ON (ptyxio2.antikeimeno = ptyxio1.antikeimeno AND ptyxio1.foreas IS NOT NULL) OR (ptyxio2.antikeimeno IS NULL AND ptyxio1.foreas IS NOT NULL) JOIN PERILAMVANEI pe
ON ptyxio1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND ptyxio1.antikeimeno IS NOT NULL)	OR ptyxio2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE e.kod_endiaferomenou = 70) AS t2,
(SELECT DISTINCT th.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON apa.proson = gnosh2.kod_prosontos JOIN GNOSH gnosh1
ON (gnosh2.antikeimeno = gnosh1.antikeimeno AND gnosh1.zhteitai = 0) OR (gnosh2.antikeimeno IS NULL AND gnosh1.zhteitai = 0) JOIN PERILAMVANEI pe
ON gnosh1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND gnosh1.antikeimeno IS NOT NULL)	OR gnosh2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE e.kod_endiaferomenou = 70
GROUP BY ai.kod_aithshs 
HAVING COUNT(gnosh1.antikeimeno) >= (SELECT COUNT(gnosh2.antikeimeno)
FROM THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON (apa.proson = gnosh2.kod_prosontos)
WHERE e.kod_endiaferomenou = 70)) AS t3
WHERE t1.kod_theshs = t2.kod_theshs
AND t2.kod_theshs = t3.kod_theshs




























SELECT DISTINCT t1.*
FROM (SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN ((((THESI_ERGASIAS th LEFT JOIN PROYPOTHETEI proipo
ON th.kod_theshs = proipo.kod_ergasias) LEFT JOIN PROIPIRESIA proipiresia2
ON proipo.kod_proipiresias = proipiresia2.kod_proipiresias) JOIN PROIPIRESIA proipiresia1
ON ((proipiresia2.tomeas = proipiresia1.tomeas AND proipiresia2.diarkeia <= proipiresia1.diarkeia) OR (proipiresia2.tomeas IS NULL AND proipiresia1.posto IS NOT NULL))) JOIN DIATHETEI d
ON proipiresia1.kod_proipiresias = d.kod_proipiresias)
ON (ai.kod_aithshs = d.aithsh AND proipiresia1.tomeas IS NOT NULL) OR (proipiresia2.tomeas IS NULL)JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou JOIN AFORA af
ON ai.kod_aithshs = af.aithsh JOIN TOMEAS_ERGASIAS tomeas
ON af.tomeas = tomeas.onoma JOIN ANHKEI an
ON tomeas.onoma = an.tomeas AND th.kod_theshs = an.kod_ergasias
WHERE th.kod_theshs = 21) AS t1,
(SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM PTYXIO p)) LEFT JOIN PTYXIO ptyxio2
ON (apa.proson = ptyxio2.kod_prosontos) JOIN PTYXIO ptyxio1
ON (ptyxio2.antikeimeno = ptyxio1.antikeimeno AND ptyxio1.foreas IS NOT NULL) OR (ptyxio2.antikeimeno IS NULL AND ptyxio1.foreas IS NOT NULL) JOIN PERILAMVANEI pe
ON ptyxio1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND ptyxio1.antikeimeno IS NOT NULL)	OR ptyxio2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE th.kod_theshs = 21) AS t2
WHERE t1.kod_endiaferomenou = t2.kod_endiaferomenou


SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN ((((THESI_ERGASIAS th LEFT JOIN PROYPOTHETEI proipo
ON th.kod_theshs = proipo.kod_ergasias) LEFT JOIN PROIPIRESIA proipiresia2
ON proipo.kod_proipiresias = proipiresia2.kod_proipiresias) JOIN PROIPIRESIA proipiresia1
ON ((proipiresia2.tomeas = proipiresia1.tomeas AND proipiresia2.diarkeia <= proipiresia1.diarkeia) OR (proipiresia2.tomeas IS NULL AND proipiresia1.posto IS NOT NULL))) JOIN DIATHETEI d
ON proipiresia1.kod_proipiresias = d.kod_proipiresias)
ON (ai.kod_aithshs = d.aithsh AND proipiresia1.tomeas IS NOT NULL) OR (proipiresia2.tomeas IS NULL)JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou 
WHERE th.kod_theshs = 1

SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN ((((THESI_ERGASIAS th LEFT JOIN PROYPOTHETEI proipo
ON th.kod_theshs = proipo.kod_ergasias) LEFT JOIN PROIPIRESIA proipiresia2
ON proipo.kod_proipiresias = proipiresia2.kod_proipiresias) JOIN PROIPIRESIA proipiresia1
ON ((proipiresia2.tomeas = proipiresia1.tomeas AND proipiresia2.diarkeia <= proipiresia1.diarkeia) OR (proipiresia2.tomeas IS NULL AND proipiresia1.posto IS NOT NULL))) JOIN DIATHETEI d
ON proipiresia1.kod_proipiresias = d.kod_proipiresias)
ON (ai.kod_aithshs = d.aithsh AND proipiresia1.tomeas IS NOT NULL) OR (proipiresia2.tomeas IS NULL)JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou JOIN AFORA af
ON ai.kod_aithshs = af.aithsh JOIN TOMEAS_ERGASIAS tomeas
ON af.tomeas = tomeas.onoma JOIN ANHKEI an
ON tomeas.onoma = an.tomeas AND th.kod_theshs = an.kod_ergasias
WHERE th.kod_theshs = 1


SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM PTYXIO p)) LEFT JOIN PTYXIO ptyxio2
ON (apa.proson = ptyxio2.kod_prosontos) JOIN PTYXIO ptyxio1
ON (ptyxio2.antikeimeno = ptyxio1.antikeimeno AND ptyxio1.foreas IS NOT NULL) OR (ptyxio2.antikeimeno IS NULL AND ptyxio1.foreas IS NOT NULL) JOIN PERILAMVANEI pe
ON ptyxio1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND ptyxio1.antikeimeno IS NOT NULL)	OR ptyxio2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE th.kod_theshs = 1













SELECT DISTINCT e.*
FROM AITHSH_ERGASIAS ai JOIN (THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON apa.proson = gnosh2.kod_prosontos JOIN GNOSH gnosh1
ON (gnosh2.antikeimeno = gnosh1.antikeimeno) OR (gnosh2.antikeimeno IS NULL) JOIN PERILAMVANEI pe
ON gnosh1.kod_prosontos = pe.proson)
ON (ai.kod_aithshs = pe.aithsh AND gnosh1.antikeimeno IS NOT NULL)	OR gnosh2.antikeimeno IS NULL JOIN ENDIAFEROMENOS e
ON ai.kod_endiaferomenou_aithshs = e.kod_endiaferomenou
WHERE th.kod_theshs = 1
GROUP BY ai.kod_aithshs 
HAVING COUNT(gnosh1.antikeimeno) >= (SELECT COUNT(gnosh2.antikeimeno)
FROM THESI_ERGASIAS th LEFT JOIN APAITEI apa
ON (th.kod_theshs = apa.kod_ergasias AND apa.proson IN (SELECT kod_prosontos FROM GNOSH p)) LEFT JOIN GNOSH gnosh2
ON (apa.proson = gnosh2.kod_prosontos)
WHERE th.kod_theshs = 1)

