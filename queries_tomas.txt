-- 1. Να βρεθούν όλες οι θέσεις εργασίας στον νομό Αχαΐας από την εταιρία "ΕΘΝΙΚΗ ΤΡΑΠΕΖΑ ΤΗΣ ΕΛΛΑΔΟΣ Α.Ε."
SELECT *
FROM THESI_ERGASIAS
WHERE topos LIKE '%Νομός Αχαΐας%' 
AND etairia LIKE 'ΕΘΝΙΚΗ ΤΡΑΠΕΖΑ ΤΗΣ ΕΛΛΑΔΟΣ Α.Ε.'

-- 2. Να βρεθεί ο μέσος μισθός για τις θέσεις εργιασίας που έχουν να κάνουν με "Αγροτικά" στον νομό Αττκής
SELECT AVG(thesi_ergasias.misthos) AS mesos_misthos
FROM thesi_ergasias,anhkei,tomeas_ergasias
WHERE thesi_ergasias.kod_thesis = anhkei.kod_ergasias
	AND anhkei.kod_ergasias= tomeas_ergasias.onoma
	AND tomeas_ergasias.onoma LIKE '%Αγροτικά%'
	AND tomeas_ergasias.topos LIKE '%Νομός Αττικής%'


-- 3. Να βρεθεί η περιοχή(ές) που έχει(ουν) την μεγαλύτερη ζήτηση εργασίας
SELECT topos_endiaferontos 
FROM aithsh_ergasias
GROUP BY topos_endiaferontos
HAVING COUNT(*) = (
                   SELECT MAX(Cnt) 
                   FROM(
                         SELECT COUNT(*) as Cnt
                         FROM aithsh_ergasias
                         GROUP BY topos_endiaferontos
                        ) tmp
                    )


-- 4. Να βρεθούν τα ονόματα και τα τηλέφωνα των ενδιαφερόμενων που κατέχουν πτυχίο X και έχουν δηλώσει τόπο ενδιαφέροντος τον Νομό Y. 
SELECT onoma,eponymo,email,thlefwno
FROM ((((ENDIAFEROMENOS e JOIN AITHSH_ERGASIAS a
ON e.kod_endiaferomenou = a.kod_endiaferomenou_aithshs) JOIN PERILAMVANEI pe
ON a.kod_aithshs = pe.aithsh) JOIN PROSONTA pr
ON pe.proson = pr.kod_prosontos) JOIN PTYXIO pt
ON pr.kod_prosontos = pt.kod_prosontos) JOIN THLEFWNO_ENDIAFEROMENOU t
ON e.kod_endiaferomenou = t.endiaferomenos
WHERE a.topos_endiaferontos LIKE "%Y%"
AND pt.antikeimeno LIKE "%X%"


-- 5. Να βρεθει ο μεσος χρονιαίος σμισθος για τις θεσεις εργασιας ανα περιοχη και να γινει φθινουσα ταξινομηση
SELECT topos,CAST(AVG(misthos) AS INT) AS AVG_MISTHOS
FROM THESI_ERGASIAS
GROUP BY topos 
ORDER BY AVG(misthos) DESC


-- 6. Να βρεθεουν ολοι οσοι ικανοποιουν τις προυποθεσεις για την θεση εργασιας με αριθμο Χ

-- 7. Να βρεθούν οι ενδιαφερόμενοι που που δεν έχει λήξει η αίτηση τους στον Νομό Θεσσαλονίκης
select endiaferomenos.*
from endiaferomenos, aithsh_ergasias
where endiaferomenos.kod_endiaferomenou = aithsh_ergasias.kod_endiaferomenou_aithshs
	AND aithsh_ergasias.topos_endiaferontos LIKE '%Νομός Θεσσαλονίκης%'
	AND date('now')<aithsh_ergasias.hmeromhnia_lhxhs_aithshs

-- 8. Να βρεθεί η θέση εργασίας με τον υψηλοτερο μισθο για την οποία ικανοποιεί τις πορυποθεσεις ο εργαζομενος με αριθμο Χ

-- 9.  Να βρεθούν οι ενδιαφερόμενοι που έχουν προυπηρεσία στο ποστο Χ και έχουν γνώση Υ
select distinct endiaferomenos.*
from endiaferomenos,aithsh_ergasias,diathetei,proipiresia,perilamvanei,gnosh
where endiaferomenos.kod_endiaferomenou = aithsh_ergasias.kod_endiaferomenou_aithshs
	AND aithsh_ergasias.kod_aithshs = diathetei.aithsh
	AND diathetei.kod_proipiresias = proipiresia.kod_proipiresias
	AND aithsh_ergasias.kod_aithshs = perilamvanei.aithsh
	AND perilamvanei.proson = gnosh.kod_prosontos
	AND proipiresia.posto LIKE '%X%'
	AND gnosh.antikeimeno LIKE '%Y%'

-- 10. Να βρεθούν τα ονόματα και τα email των ενδιαφεροντων και των εργοδοτων που έχουν να κάνουν με ΤΟΜΕΑ Χ, ΠΟΣΤΟ Υ, ΠΤΥΧΙΟ Ζ


-- 11. Εισαγωγή νέας αίτησης εργασίας είτε υπάρχοντος ενδιαφερόμενου είτε όχι

-- 12. Εισαγωγή νέας θέσης εργασίας έιτε υπάρχνοντος εργοδότη είτε όχι

-- 13. Διαγραφή αίτησης εργασίας

-- 14. Διαγραφή θέσης εργασίας